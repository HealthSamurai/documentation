@tailwind base;
@tailwind components;
@tailwind utilities;

/* ================================================
   Component Classes
   ================================================ */
.link {
  @apply text-primary-9 underline underline-offset-2 decoration-1 hover:text-primary-10 hover:decoration-2 transition-all duration-200 inline-flex items-center gap-1;
}

/* Overlay for mobile menu */
.mobile-menu-overlay {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5);
  z-index: 30;
}

.mobile-menu-overlay.active {
  display: block;
}

/* ================================================
   Markdown Content Styles (Must remain for generated content)
   ================================================ */

/* Typography - Basic elements */
ul {
  @apply ml-8 list-disc text-gray-900;
}

ul > li {
  @apply mt-2;
}

/* Add margin-bottom to p tags that are not inside li */
p:not(li p) {
  @apply my-2;
}

strong {
  @apply text-black font-semibold;
}

/* Tables */
table {
  @apply min-w-full border border-tint-subtle rounded-lg bg-white shadow-sm my-6;
}

thead {
  @apply border-b border-tint-subtle;
}

tbody {
  @apply divide-y divide-tint-subtle;
}

tr {
  @apply hover:bg-tint-hover transition-colors duration-200;
}

td {
  @apply px-4 py-3 text-base text-gray-900 leading-relaxed border-r border-tint-subtle/50 last:border-r-0 text-tint-strong/80 text-left;
}

th {
  @apply px-4 py-4 text-sm border-r border-tint-subtle/50 last:border-r-0 text-tint-strong font-semibold text-left;
}

/* Special mark styling */
mark[style*="background-color:blue"] {
  background-color: #dbeafe !important;
  color: #1e40af !important;
}

/* ================================================
   Content Container Styles (#content)
   ================================================ */

/* Base content styles */
#content {
  max-width: 100% !important;
  overflow-x: hidden !important;
}

/* Figure and Images */
#content figure {
  @apply flex flex-col items-center justify-center my-8;
}

#content figure img {
  @apply max-w-full h-auto mx-auto rounded-lg shadow-aidbox-lg;
}

#content figure figcaption {
  @apply mt-3 text-sm text-center text-aidbox-text-muted;
}

/* Code Blocks */
#content pre {
  @apply border border-gray-200 text-gray-800 rounded-lg overflow-x-auto max-w-full shadow-sm;
  white-space: pre !important;
  width: 100% !important;
  max-width: 100% !important;
  box-sizing: border-box !important;
}

#content pre + pre {
  @apply mt-4;
}

#content pre code {
  @apply text-base leading-relaxed block p-4;
  white-space: pre !important;
  max-width: 100% !important;
  min-width: 0;
  display: block;
  width: 100%;
  box-sizing: border-box;
}

/* General code block styling (outside #content) */
pre {
  @apply relative;
}

pre code {
  @apply block w-full;
}

/* Details and Summary */
#content details {
  @apply my-6 border border-gray-200 rounded-lg bg-white shadow-sm overflow-hidden;
}

#content summary {
  @apply px-6 py-4 border-b border-gray-200 cursor-pointer select-none font-medium text-gray-900 hover:bg-gray-100 transition-colors duration-200 flex items-center justify-between;
}

#content summary:hover {
  @apply bg-gray-100;
}

#content summary::after {
  content: "â–¼";
  @apply text-gray-500 text-sm transition-transform duration-200;
}

#content details[open] summary::after {
  transform: rotate(180deg);
}

#content details > *:not(summary) {
  @apply px-6 py-4;
}

#content details > *:not(summary):last-child {
  @apply pb-6;
}

/* ================================================
   Navigation and UI Components
   ================================================ */

/* TOC Sticky positioning */
#toc-container {
  position: sticky !important;
  top: 4rem !important;
  height: calc(100vh - 4rem) !important;
  overflow-y: auto !important;
  z-index: 50 !important;
  align-self: flex-start !important;
  flex-shrink: 0 !important;
}

/* Ensure parent flex container allows sticky positioning */
.flex.gap-8 {
  align-items: flex-start !important;
  overflow: visible !important;
}

/* TOC links */
.toc a {
  @apply block py-2 text-sm text-tint-strong/70 hover:text-tint-strong transition-colors duration-200 no-underline truncate max-w-full overflow-hidden;
}

.toc a.active {
  @apply text-primary-9 font-medium;
}

/* Navigation active state */
#navigation a.active {
  @apply text-primary-9 font-bold;
}

/* Hint/Admonition styles */
.hint img {
  max-width: 300px !important;
  height: auto !important;
}

.hint p:first-child {
  @apply mt-0;
}

.hint p:last-child {
  @apply mb-0;
}

.hint p {
  @apply my-2;
}

/* Code copy button */
.copy-code-btn {
  @apply z-10;
}

.copy-code-btn:hover {
  @apply bg-gray-600;
}

.copy-code-btn:focus {
  @apply outline-none ring-2 ring-blue-500 ring-offset-2;
}

/* ================================================
   Mobile Responsive Styles
   ================================================ */

/* Mobile Navigation */
@media (max-width: 767px) {
  /* TOC Container - hide on mobile */
  #toc-container {
    display: none !important;
  }

  /* Navigation */
  #navigation {
    display: none !important;
  }

  #navigation.mobile-open {
    display: block !important;
    position: fixed !important;
    top: 4rem !important;
    left: 0 !important;
    width: 100% !important;
    height: calc(100vh - 4rem) !important;
    background: white !important;
    z-index: 40 !important;
    overflow-y: auto !important;
    padding: 1rem !important;
    box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1) !important;
    border-radius: 0 !important;
    border: none !important;
  }

  /* Layout adjustments */
  .flex.gap-20 {
    gap: 0 !important;
  }

  /* Hide copy button on mobile */
  .copy-code-btn {
    display: none !important;
  }

  /* Article content - empty class kept for Telegram instant view */
  .article__content {
    /* Intentionally empty - used as a marker for Telegram instant view */
  }

  /* Search containers */
  #search-results {
    width: 100% !important;
    min-width: 100% !important;
  }

  #search-input {
    width: 100% !important;
    min-width: 100% !important;
  }
}

/* Mobile content optimization */
@media (max-width: 767px) {
  /* Content container */
  #content {
    max-width: 100vw !important;
    overflow-x: hidden !important;
    padding-left: 0 !important;
    padding-right: 0 !important;
    box-sizing: border-box !important;
  }

  #content > * {
    max-width: 100% !important;
    box-sizing: border-box !important;
    overflow-x: hidden !important;
  }

  /* Text content */
  #content p,
  #content div,
  #content blockquote,
  #content table {
    max-width: 100% !important;
    box-sizing: border-box !important;
    overflow-x: hidden !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    hyphens: none !important;
  }

  /* Handle long URLs and text */
  #content a {
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    hyphens: none !important;
  }

  /* Force all text to wrap */
  #content * {
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    hyphens: none !important;
  }

  /* Code blocks special handling */
  #content pre {
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch;
    max-width: 100%;
    margin-left: 0;
    margin-right: 0;
    padding-left: 1rem;
    padding-right: 1rem;
    white-space: pre !important;
  }

  #content pre code {
    min-width: 0;
    white-space: pre !important;
    max-width: 100% !important;
  }

  /* Tables scrollable on mobile */
  #content table {
    display: block !important;
    overflow-x: auto !important;
    white-space: nowrap !important;
  }
}

/* Desktop styles */
@media (min-width: 768px) {
  /* Desktop search container */
  .min-w-4xl {
    min-width: 56rem !important;
  }

  #search-results {
    width: 80rem !important;
    min-width: 80rem !important;
  }

  #search-input {
    width: 80rem !important;
    min-width: 80rem !important;
  }
}
